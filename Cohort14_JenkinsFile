pipeline {
  agent any
  tools {
    maven 'Maven3.9.4'
  }
  environment {
    GIT_REPO_URL = 'https://github.com/ciwuezi/maven-web-app.git'
  }
  stages{
    stage('Predeployment - Building containers with base images'){
      steps{
        docker build -t tomcat:jre11 -f DockerfileTomcat .
        docker run --name tomcat -d -p 7000:8080 tomcat:jre11
        docker build -t nexus:3.67.1 -f DockerfileNexus .
        docker run --name nexus -d -p 8081:8081 nexus:3.67.1
        docker build -t sonarqube:lts -f DockerfileSonarqube .
        docker run --name sonarqube -d -p 9000:9000 sonarqube:lts
      }
    }
  }
}
